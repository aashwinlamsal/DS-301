---
title: "DS301_HW2"
author: "Aashwin Lamsal"
date: "2/16/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## DS 301 Homework 2

## Question 1
```{r}
#PART A
library(ISLR)
#viewing the dataset
#head(Auto) 
#names(Auto)

#Y=mpg, and is going to become our response vector
Y = Auto$mpg

#dim(Auto) used to check the dimensions of the entire table, 392 rows by 9 columns

n = dim(Auto)[1] #the dimensions of the response vector are 392 rows by 1 column
print("Dimensions for Y")
n
#X=horsepower, and is going to become our design matrix

X = cbind(rep(1,n), Auto$horsepower) #first column is full of 1's always
xdim = dim(X) # the dimensions of the design matrix is 392 rows by 2 columns
print("Dimensions for X")
xdim

#PART B
#Calculating X transpose times X
XtX = t(X)%*%X
print("X transpose times X")
XtX

#Calculating X transpose times Y
XtY = t(X)%*%Y
print("X transpose times Y")
XtY

#Calculating the inverse of X transpose times X
XtX_inverse = solve(XtX)
print("The inverse of X transpose times X")
XtX_inverse

#PART C
#Calculating least squares estimate, beta hat
betaHat = XtX_inverse %*% XtY
print("Beta Hat")
betaHat

#model = lm(Y~X, Auto)
#summary(model) lm output used here to double check my results

#PART D
#plot(x=Auto$horsepower, y = Auto$mpg) plotting the relationshsip between mpg and horsepower

#The response vector doesn't change, but the values in the design matrix will be squared to address the quadratic nature. The model continues to be a simple linear regression model with Y = mpg and X = horsepower^2.

Xsquared = cbind(rep(1,n), (Auto$horsepower)^2)

newXtX = t(Xsquared)%*%Xsquared
print("New X transpose times X")
newXtX

newXtY = t(Xsquared)%*%Y
print("New X transpose times Y")
newXtY

newXtX_inverse = solve(newXtX)
print("The new inverse of X transpose times X")
newXtX_inverse

newbetaHat = newXtX_inverse %*% newXtY
print("The new Beta Hat")
newbetaHat

#model = lm(Y~Xsquared, Auto)
#summary(model)  again, using lm output used here to double check my results
```
### The dimensions of the response vector are 392 rows by 1 column.The dimensions of the design matrix is 392 rows by 2 columns. 

### Answers for Part B, C, and D was displayed in the output, and written down on the attached notebook paper.

## Question 2
```{r}
#PART A
library(jtools)

patient = read.table("/Users/aashw/Documents/DS-301/patient.txt")
names(patient) = c("satisf","age","severe","anxiety")
#head(patient) checking the first 6 rows

#Response vector
Y = patient$satisf
n = dim(patient)[1]

#Design matrix
X = cbind(rep(1,n),patient$age, patient$severe, patient$anxiety)


#Fitting the model
model=lm(Y~age+severe+anxiety,data=patient)
print("Output table (numbers are rounded from the lm output due to the jtools table, the exact numbers are on the notebook paper)")
summ(model)

#PART B
#Conducting an F-Test on all of our predictors
print("Part B")
p = 4
alpha = 0.05
#Test statistic
f_star = 30.05

#p-value 
pValue= pf(F_star,df1,df2,lower.tail=FALSE)
print("P-value:")
pValue

#Decision Rule
print("Is the P-Value less than our significance level? If true, reject the null hypothesis.")
pValue < alpha

#PART C
#Conducting a T-Test on beta 1
#Calculating least square estimators
print("Part C")
XtX = t(X)%*%X

betaHat = solve(XtX)%*%t(X)%*%Y

Yhat = X%*%betaHat  
errors = Y - Yhat

#Test statistic
ts = -5.314796 #gotten from lm output summary
print("Test statistic for beta 1, as given by the lm summary:")
ts

#beta 1 p-value 

pValueB1 = 2*pt(abs(ts),n-p,lower.tail=FALSE)
print("P-Value for Beta 1:")
pValueB1

#Decision Rule
print("Is the P-Value less than our significance level? If true, reject the null hypothesis")
pValueB1 < alpha

#PART D
print("Part D: the estimate for sigma squared (sigma hat squared) is:")
sigma_hat = sqrt(sum(errors^2)/(n-p))
sigma_hat_squared = (sigma_hat)^2
sigma_hat_squared

#PART E: hand written on the notebook paper
```

### For part A, the interpretation of the summary output is on the attached notebook paper. The conclusion to part B's f-test: we reject the null hypothesis, as we found evidence that there is a relationship between a patient's satsifaction rating and, at least, one of our predictors: age, severity level, and anxiety level.

